{% extends "base.html" %}
{% load blog_tags %}

{% block content %}
    <div class="container mt-4">
        {% if messages %}
            {% for message in messages %}
                {% if message.tags == 'success' %}
                    <div class="alert alert-success alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endif %}
            {% endfor %}
        {% endif %}

        <h2>Профиль пользователя</h2>
        <p>Имя пользователя: {{ request.user.username }}</p>
        <p>Email: {{ request.user.email }}</p>
        <a href="{% url "users:logout" %}" style="color:blue;">Выйти</a>

        <div class="posts-wrapper mt-4">
            {% block head-tag %}{% endblock head-tag %}
            {% for post in posts %}
                {% block head-cat %}{% endblock head-cat %}
                <div class="post-wrapper">
                    <div class="post-wrapper-head">
                        <a class="post-title-link" href="{{ post.get_absolute_url }}">
                            <h2>{{ post.title }}</h2>
                        </a>
                        <div class="post-wrapper-head-right">
                            <span>{{ post.author }}</span>
                            <span>{{ post.published_at }}</span>
                        </div>
                    </div>
                    <p>Категория: <a style="color:#0069d9;" href="{{ post.category.get_absolute_url }}">{{ post.category.title }}</a></p>
                    <div class="tags-wrapper">{% show_tags post.id %}</div>
                    <div class="post-content">
                        {{ post.content|safe|truncatewords_html:50 }}
                    </div>
                    <form class="post-change-form" action="{% url "blog:delete_post" post.id %}" method="post">
                        {% csrf_token %}
                        <a href="{% url "blog:edit_post" post.id %}">Редактировать</a>
                        <button type="submit">Удалить</button>
                    </form>
                </div>
            {% empty %}
                <h1>Нет постов</h1>
            {% endfor %}
        </div>
        {% include 'blog/includes/pagination.html' with page=posts %}
    </div>
{% endblock %}
